<!doctype html>
<html lang="nl">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Mini CRM Lead Form (Test)</title>
    <style>
      body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, sans-serif; max-width: 680px; margin: 2rem auto; padding: 0 1rem; }
      label { display:block; margin:.5rem 0 .25rem; }
      input, textarea { width:100%; padding:.6rem; border:1px solid #ccc; border-radius: .5rem; }
      button { padding:.7rem 1rem; border:0; border-radius:.7rem; background:#111; color:#fff; margin-top:1rem; }
      .ok { color: green; }
      .err { color: crimson; }
      .small { color:#666; font-size:.9rem; }
    </style>
  </head>
  <body>
    <h1>Mini CRM (Test)</h1>
    <p class="small">Vul het formulier in en klik op verzenden. Dit simuleert de klik vanuit een video reel.</p>
    <form id="leadForm">
      <label>Volledige naam</label>
      <input name="fullName" required />
      <label>Eâ€‘mail</label>
      <input name="email" type="email" required />
      <label>Telefoon</label>
      <input name="phone" />
      <label>Notities</label>
      <textarea name="notes"></textarea>
      <label><input type="checkbox" name="consent" checked/> Ik geef toestemming om gebeld te worden</label>
      <button type="submit">Verzenden</button>
    </form>
    <pre id="out"></pre>
    <script>
      const form = document.getElementById('leadForm');
      const out = document.getElementById('out');
      form.addEventListener('submit', async (e) => {
        e.preventDefault();
        const data = Object.fromEntries(new FormData(form).entries());
        if (data.consent === 'on') data.consent = true;
        try {
          const res = await fetch('/leads', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify(data)
          });
          const json = await res.json();
          out.textContent = JSON.stringify(json, null, 2);
          out.className = json.ok ? 'ok' : 'err';
        } catch (err) {
          out.textContent = err.message;
          out.className = 'err';
        }
      });
    </script>
  </body>
</html>
