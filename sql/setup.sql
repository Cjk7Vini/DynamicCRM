-- Run this as SYSTEM in the PDB (FREEPDB1 for 23c Free, or XEPDB1 for 21c XE)
-- Example connect: sqlplus system@localhost:1521/FREEPDB1
-- Then:  @/opt/mini-crm/sql/setup.sql

-- Create application user & schema
CREATE USER MINI_CRM IDENTIFIED BY "ChangeMe123!"
  DEFAULT TABLESPACE USERS
  TEMPORARY TABLESPACE TEMP
  QUOTA UNLIMITED ON USERS;

GRANT CREATE SESSION, CREATE TABLE, CREATE SEQUENCE TO MINI_CRM;

-- Table to store leads
CREATE TABLE MINI_CRM.LEADS (
  ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  FULL_NAME VARCHAR2(200) NOT NULL,
  EMAIL VARCHAR2(320) NOT NULL,
  PHONE VARCHAR2(50),
  NOTES VARCHAR2(2000),
  CONSENT NUMBER(1) DEFAULT 1 NOT NULL,
  SOURCE VARCHAR2(100),
  CREATED_AT TIMESTAMP DEFAULT SYSTIMESTAMP NOT NULL
);

CREATE INDEX MINI_CRM.IDX_LEADS_EMAIL ON MINI_CRM.LEADS(EMAIL);
